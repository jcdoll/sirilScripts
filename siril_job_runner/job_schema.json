{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Siril Job File",
  "description": "Configuration for a Siril image processing job",
  "type": "object",
  "required": ["name", "type", "calibration", "lights", "output"],
  "properties": {
    "name": {
      "type": "string",
      "description": "Job name for logging and output files",
      "minLength": 1
    },
    "type": {
      "type": "string",
      "enum": ["LRGB", "SHO", "HOO"],
      "description": "Type of imaging data"
    },
    "calibration": {
      "type": "object",
      "description": "Dates for calibration data",
      "required": ["bias", "darks", "flats"],
      "properties": {
        "bias": {
          "type": "string",
          "pattern": "^\\d{4}_\\d{2}_\\d{2}$",
          "description": "Date for bias frames (YYYY_MM_DD)"
        },
        "darks": {
          "type": "string",
          "pattern": "^\\d{4}_\\d{2}_\\d{2}$",
          "description": "Date for dark frames (YYYY_MM_DD)"
        },
        "flats": {
          "type": "string",
          "pattern": "^\\d{4}_\\d{2}_\\d{2}$",
          "description": "Date for flat frames (YYYY_MM_DD)"
        }
      }
    },
    "lights": {
      "type": "object",
      "description": "Light frame directories per filter",
      "minProperties": 1,
      "additionalProperties": {
        "oneOf": [
          {
            "type": "string",
            "description": "Single directory path"
          },
          {
            "type": "array",
            "items": {
              "type": "string"
            },
            "minItems": 1,
            "description": "Multiple directory paths (multi-night)"
          }
        ]
      }
    },
    "output": {
      "type": "string",
      "description": "Output directory for processed files",
      "minLength": 1
    },
    "options": {
      "type": "object",
      "description": "Optional processing parameters",
      "properties": {
        "fwhm_filter": {
          "type": "number",
          "minimum": 0,
          "default": 1.8,
          "description": "FWHM filter factor for frame rejection"
        },
        "temp_tolerance": {
          "type": "number",
          "minimum": 0,
          "default": 2.0,
          "description": "Temperature tolerance for calibration matching (Celsius)"
        },
        "denoise": {
          "type": "boolean",
          "default": false,
          "description": "Apply denoising"
        },
        "palette": {
          "type": "string",
          "enum": ["HOO", "SHO_blue_gold", "SHO_blue_red", "SHO_natural"],
          "default": "HOO",
          "description": "Narrowband palette for SHO/HOO types"
        },
        "dark_temp_override": {
          "type": "number",
          "description": "Force using darks at this temperature (Celsius) regardless of light frame temperatures"
        }
      }
    }
  }
}
